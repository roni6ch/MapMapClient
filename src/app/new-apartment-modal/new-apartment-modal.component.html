<!-- Modal Structure -->
<div class="modal fade" id="newApartmentWindowModal" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">

  <button #btnClose type="button" class="close" data-dismiss="modal" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>

  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <form #apartmentForm="ngForm" (ngSubmit)="publishNewApartment(apartmentForm)">
        <h6>Publish New Apartment!</h6>
        <hr>
        <div class="row">
          <div class="col s12">

            <!-- Name -->
            <div class="input-field col s6">
              <i class="material-icons prefix">account_circle</i>
              <input [(ngModel)]="apartment.publisher.name" #name="ngModel" name="name" id="inputFirstName" minlength="2" maxlength="20" type="text" class="validate"
                required data-length="20" materialize="characterCounter" (focus)="submittedError = false">
              <label for="inputFirstName">First Name</label>
              <span class="helper-text" data-error="wrong" data-success="right"></span>


              <div *ngIf="name.invalid && (name.dirty || name.touched) ||  submittedError">
                <div *ngIf="name.errors?.required" class="alert alert-danger">
                  Name is required.
                </div>
                <div *ngIf="name.errors?.minlength" class="alert alert-danger">
                  Name must be at least 2 characters long.
                </div>
                <div *ngIf="name.errors?.maxlength" class="alert alert-danger">
                    Name must be at Max 20 characters long.
                  </div>
              </div>

            </div>
            <!-- Phone -->
            <div class="input-field col s6">
              <i class="material-icons prefix">phone</i>
              <input [(ngModel)]="apartment.publisher.phone" #phone="ngModel" name="phone" id="icon_telephone" type="number" class="validate"
                minlength="9"  maxlength="15" required data-length="10" (focus)="submittedError = false" placeholder="050-0000000">
              <label for="icon_telephone">Telephone</label>
              <span class="helper-text" data-error="wrong" data-success="right"></span>

              <div *ngIf="phone.invalid && (phone.dirty || phone.touched) ||  submittedError">
                <div *ngIf="phone.errors?.required" class="alert alert-danger">
                  Phone is required.
                </div>
                <div *ngIf="phone.errors?.minlength" class="alert alert-danger">
                  Phone must be at least 9 digits.
                </div>
                <div *ngIf="phone.errors?.maxlength" class="alert alert-danger">
                    Phone must be at Max of 15 digits.
                  </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col s12">

            <!-- Price -->
            <div class="input-field col s4">
              <i class="material-icons prefix">
                <img src="assets/images/icons/coins/ils.png" />
              </i>
              <input [(ngModel)]="apartment.details.price" #price="ngModel" name="price" id="inputPrice" type="number" data-length="10" class="validate"
                required onkeypress='return event.charCode >= 48 && event.charCode <= 57' pattern="[0-9,.]{3,10}" />
              <label for="inputPrice">Price</label>
              <span class="helper-text" data-error="wrong" data-success="right"></span>

              <div *ngIf="price.invalid && (price.dirty || price.touched) ||  submittedError">
                  <div *ngIf="price.errors?.required" class="alert alert-danger">
                    Price is required.
                  </div>
                  <div *ngIf="price.errors?.minlength" class="alert alert-danger">
                      Price must be at least 3 characters long.
                  </div>
                  <div *ngIf="price.errors?.maxlength" class="alert alert-danger">
                      Price must be at most 10 characters long.
                  </div>
                </div>

            </div>
            <!-- Email -->
            <div class="input-field col s4">
              <i class="material-icons prefix">email</i>
              <input [(ngModel)]="apartment.publisher.email" name="email" id="inputMail" type="email" class="validate" data-length="30"
                min="10" max="15" />
              <label for="inputMail">Email</label>
              <span class="helper-text" data-error="wrong" data-success="right"></span>
            </div>

            <!-- Date -->
            <div class="input-field col s4">
              <i class="material-icons prefix">date_range</i>

              <input type="text" class="datepicker" #date="ngModel" [(ngModel)]="apartment.details.entrance_date" name="date" id="inputDate" required
                (change)="changeDate()" />

              <label for="inputMail">Date</label>
              <span class="helper-text" data-error="wrong" data-success="right"></span>

              <div *ngIf="date.invalid && (date.dirty || date.touched) ||  submittedError">
                  <div *ngIf="date.errors?.required" class="alert alert-danger">
                      Date is required.
                  </div>
                </div>
            </div>
          </div>
        </div>

        <!-- Location -->
        <div class="input-field col s6">
          <i class="material-icons prefix">account_circle</i>

          <input #search name="location" [(ngModel)]="apartment.location.address" autocorrect="off" autocapitalize="off" spellcheck="off" required
            class="form-control mr-sm-2 " type="search" id="inputLocation" placeholder="Search for location" aria-label="Search">
          <label for="inputLocation">Location</label>
        </div>

        <!-- info -->
        <div class="row">
          <div class="input-field col s10">
            <i class="material-icons prefix">create</i>
            <textarea [(ngModel)]="apartment.details.info" name="description" id="inputDescription" class="materialize-textarea" data-length="250"></textarea>
            <label for="inputDescription">Description...</label>
            <span class="helper-text" data-error="wrong" data-success="right"></span>
          </div>

          <!-- size -->
          <div class="input-field col-s2">
            <input [(ngModel)]="apartment.details.size" name="size" id="inputSize" type="number" class="validate apartmentSize" />
            <label for="inputSize">Size</label>
            <span class="helper-text" data-error="wrong" data-success="right"></span>
          </div>
        </div>

        <!-- Images -->
        <app-image-uploader (images)="addImagesToForm($event)"></app-image-uploader>
        <!-- [(ngModel)]="apartment.images" -->

        <!-- advancedFilter -->
        <div class="form-row">
          <div *ngFor="let filter of advancedFilters" class="advancedFilters advancedFilter col s2">
            <div class="switch">
              <label>
                <div class="switchIcon">
                  <img src="assets/images/icons/{{filter.filterName}}.png" />
                </div>
                <span>{{filter.name}}</span>

                <input [(ngModel)]="apartment.filters[filter.filterName]" name="filter" type="checkbox">
                <span class="lever"></span>
              </label>
            </div>
          </div>
        </div>

        <div class="row">
          <!-- apartmentType -->
          <div class="input-field col s3 apartmentType">
            <select [(ngModel)]="apartment.details.apartmentType" name="apartmentType">
              <option value="" disabled selected>Type</option>
              <option value="דירה">דירה</option>
              <option value="דירת גן">דירת גן</option>
              <option value="פרטי">פרטי</option>
            </select>
          </div>
          <!--apartmentRooms-->
          <div class="input-field col s3 apartmentRooms">
            <select [(ngModel)]="apartment.details.rooms" name="apartmentRooms">
              <option value="" disabled selected>Rooms</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="6">6</option>
              <option value="7">7</option>
              <option value="8">8+</option>
            </select>
          </div>
          <!--apartmentFloor-->
          <div class="input-field col s3 apartmentFloor">
            <select [(ngModel)]="apartment.details.floor" name="apartmentFloor">
              <option value="" disabled selected>Floor</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5</option>
              <option value="10">10+</option>
              <option value="20">20+</option>
              <option value="30">30+</option>
            </select>
          </div>
          <!--apartmentToilets-->
          <div class="input-field col s3 apartmentToilets">
            <select [(ngModel)]="apartment.details.toilets" name="apartmentToilets">
              <option value="" disabled selected>Toilets</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
            </select>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn  modal-close waves-effect  btn-flat" data-dismiss="modal" type="button">
            <span>
              Cancel
            </span>
          </button>
          <button class="btn left modal-close waves-effect  btn-flat" type="submit">
            <span>
              Publish!
            </span>
          </button>
        </div>


        <!-- TODO -->
        <input type="hidden" [(ngModel)]="apartment.id" name="publisher_user_id" value="123" />
      </form>
    </div>
  </div>
</div>
